#Assign Windows Server static IP Address 
New-NetIPAddress -IPAddress 192.168.1.254 -PrefixLength 24 -InterfaceIndex 15 - DefaultGateway 192.168.1.1

#Assign Windows Server DNS 
Set-DnsClientServerAddress -InterfaceIndex 15 -ServerAddresses 192.168.1.254

#Renames the Windows Server VM
$newname = "Net2GridGlobeXAcquisition"

Rename-Computer -NewName $newname -force

#Installs AD-Domain-Services
Install-WindowsFeature -Name AD-Domain-Services -IncludeManagementTools

#Creates an AD Forest
Install-ADDSForest -CreateDnsDelegation:$false -DatabasePath C:\Windows\NTDS -DomainMode WinThreshold -DomainName Net2GridGlobeXAcquisition.com -DomainNetbiosName Net2GridGlobeXAcquisition -ForestMode WinThreshold -InstallDns:$true -LogPath C:\Windows\NTDS -NoRebootOnCompletion:$true -SafeModeAdministratorPassword $Password -SysvolPath C:\Windows\SYSVOL -Force:$true

#Create an OU
$newou = Read-Host -Prompt "Enter Organizational Unit"
New-ADOrganizationalUnit -Name "$newou" -Path "OU=Net2GridGlobeXAcquisition,DC=corpglobexpower,DC=com"

#Create AD User
#Input variables from users
$firstname = Read-Host -Prompt "Enter First Name"
$lastname = Read-Host -Prompt "Enter Last Name"

New-ADUser `
  -Name ("$firstname $lastname") `
  -GivenName "$firstname" `
  -Surname "$lastname" `
  -UserPrincipalName "$firstname.$lastname" `
  -Path "OU=Net2GridGlobeXAcquisition,DC=corpglobexpower,DC=com" `
  -ChangePasswordAtLogon $true `
  -Enable $true `

